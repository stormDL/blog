---
title: 怎么处理分类不均衡的数据集
catalog: true
tags:
- 算法
- 面试
categories: tech
mathjax: true
date: 2020-06-15 11:30:38
---

## 简述

分类不均衡对于需要精确识别少数类别的任务来说十分不友好，比如识别诈骗账户、犯罪分子等，为了提升模型的准确率，主要要从数据和模型两方面下手，因为数据的极端不平衡，这时我们就必须处理数据。

eg.

> 现在有1000条数据，其中998条数据属于正例，仅有2条数据属于负例，这就是数据不均衡的一个例子。

在现有的模型中，比如决策树、逻辑回归或者神经网络他们都是要让全局的结果最好，这样就会导致模型会更加倾向于实例数据较多的类别（少数类别的特征就被视为噪音，通常被忽略），从而无法训练出一个较好的模型。



## 数据层面的方法：重采样

主要的做法是增加数据量少的类别或者减少数据量大的类别数据，让几个类别数量差不多。

**随机欠采样**：从多数类样本中随机选取一些数据，然后把这些采样数据跟数据量少的类别数据混合在一起作为模型训练集。

- 优点：缓解了数据分布不均衡的情况；当数据集很大的时候，通过减少训练样本的数量改善了训练时间和存储的问题。
- 缺点：负采样出来的这部分数据没有太多重要的信息，导致模型性能不好；随机采样可能时具有偏差的数据，即采样可能导致数据多样性的减少。

**随机过采样**：从样本少的类别中随机采样，然后把抽取出来的数据添加到这个样本数据中，达到增加数据量的目的。

- 优点：不会出现信息丢失。
- 缺点：因为部分数据重复出现，这增加了过拟合的风险。

**基于聚类的过采样**：对每个类别单独进行聚类，然后对某一类别下的类进行过采样处理。

- 优点： 对每个类别内部进行分类，然后进行随机过采样补全数据，最终达到缓解数据不均衡的目的。
- 缺点：增加过拟合的风险。

- eg:

  > 现有正类 998 条数据，负类 2 条数据。
  >
  > 1. 对正类的数据使用聚类算法，把正类的数据分为 6 个类别。
  >    1. cluster1: 150
  >    2. cluster2: 120
  >    3. cluster3: 230
  >    4. cluster4: 200
  >    5. cluster5: 150
  >    6. cluster6: 148
  > 2. 对负类使用聚类算法，把父类分为两个类别。
  >    1. cluster1: 1
  >    2. cluster2: 1
  > 3. 对正类当中的各个类别使用随机过采样的方法平衡数据并使正类数据总条数为1020条。
  >    1. cluster1: 170
  >    2. cluster2: 170
  >    3. cluster3: 170
  >    4. cluster4: 170
  >    5. cluster5: 170
  >    6. cluster6: 170
  > 4. 对负类中的各个类别使用随机过采样的方法平衡数据并使负类的数据总条数为500条。
  >    1. cluster1: 250
  >    2. cluster2: 250
  > 5. 最终得到的数据情况：正类 1020 条，父类 500 条。

**根据现有数据合成新的数据**：暂不做了解

## 算法层面的技术（暂不做了解）